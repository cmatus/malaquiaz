<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Title</title>
        <script src="https://code.jquery.com/jquery-1.12.2.min.js" integrity="sha256-lZFHibXzMHo3GGeehn1hudTAP3Sc0uKXBXAzHX1sjtk=" crossorigin="anonymous"></script>
        <script src="_js/funciones.js"></script>
        <script>
            
            var data = "{ 'texto': ['Claudio', 'Matus', 'Alegr√≠a'], 'corte': true, 'apertura': false }";
            var urlAPI = "http://localhost:3000/api";

            $.ajaxSetup({
                cache: false,
                async: false
            });
            /*
            function imprime(data, destino){
                var retorno = false;
                var parametro = RetornaAJAX("http://192.168.1.160/impresion/wsimprime.asmx", "imprimir", data, null);
                $.when($.ajax(parametro)).done(function (a) {
                    if (a.d != null) {
                        retorno = a.d;
                    }
                });
                return retorno;
            }

            function registraTipo(){
                var data = { 
                    tipID: $("#txtTipID_Tipo").val(),
                    nombre: $("#txtNombre_Tipo").val(),
                    nivel: $("#txtNivel_Tipo").val()
                }
                $.post(urlAPI + "/tipo", function(data) {
                    $("#txtID_Tipo").val(data._id);
                });
            }
            */

            function registraProducto(){
                var info = { 
                    'tipID': $("#txtTipID_Producto").val(),
                    'nombre': $("#txtNombre_Producto").val(),
                    'ingrediente': $("#txtIngrediente_Producto").val()
                }
                $.post(urlAPI + "/producto", info, function(data) {
                    $("#txtID_Producto").val(data._id);
                });
            }

            function registraProductoIngredientes(){
                
                var jsonIngredientes = [];
                if( $("#txtID_Ingrediente_1").val() != "" ){
                    jsonIngredientes.push({
                        'proID': $("#txtID_Ingrediente_1").val(),
                        'nombre': $("#txtNombre_Ingrediente_1").val()
                    });
                }
                if( $("#txtID_Ingrediente_2").val() != "" ){
                    jsonIngredientes.push({
                        'proID': $("#txtID_Ingrediente_2").val(),
                        'nombre': $("#txtNombre_Ingrediente_2").val()
                    });
                }
                if( $("#txtID_Ingrediente_3").val() != "" ){
                    jsonIngredientes.push({
                        'proID': $("#txtID_Ingrediente_3").val(),
                        'nombre': $("#txtNombre_Ingrediente_3").val()
                    });
                }
                if( $("#txtID_Ingrediente_4").val() != "" ){
                    jsonIngredientes.push({
                        'proID': $("#txtID_Ingrediente_4").val(),
                        'nombre': $("#txtNombre_Ingrediente_4").val()
                    });
                }
                if( $("#txtID_Ingrediente_5").val() != "" ){
                    jsonIngredientes.push({
                        'proID': $("#txtID_Ingrediente_5").val(),
                        'nombre': $("#txtNombre_Ingrediente_5").val()
                    });
                }
                
                var info = { 
                    'proID': $("#txtID_Ingrediente").val(), 
                    'ingredientes': jsonIngredientes 
                }
                $.post(urlAPI + "/producto/ingrediente", info, function(data) {
                    $("#txtID_Ingrediente").val(data._id);
                    $("#txtNombre_Ingrediente").val(data.nombre);
                });
                
            }  

            function registraProductoPrecios(){
                
                var jsonPrecios = [];
                if( $("#txtID_Precio_1").val() != "" ){
                    jsonPrecios.push({
                        'proID': $("#txtID_Precio_1").val(),
                        'nombre': $("#txtNombre_Precio_1").val()
                    });
                }
                if( $("#txtID_Precio_2").val() != "" ){
                    jsonPrecios.push({
                        'proID': $("#txtID_Precio_2").val(),
                        'nombre': $("#txtNombre_Precio_2").val()
                    });
                }
                if( $("#txtID_Precio_3").val() != "" ){
                    jsonPrecios.push({
                        'proID': $("#txtID_Precio_3").val(),
                        'nombre': $("#txtNombre_Precio_3").val()
                    });
                }
                if( $("#txtID_Precio_4").val() != "" ){
                    jsonPrecios.push({
                        'proID': $("#txtID_Precio_4").val(),
                        'nombre': $("#txtNombre_Precio_4").val()
                    });
                }
                if( $("#txtID_Precio_5").val() != "" ){
                    jsonPrecios.push({
                        'proID': $("#txtID_Precio_5").val(),
                        'nombre': $("#txtNombre_Precio_5").val()
                    });
                }
                
                var info = { 
                    'proID': $("#txtID_Precio").val(), 
                    'Precios': jsonPrecios 
                }
                $.post(urlAPI + "/producto/Precio", info, function(data) {
                    $("#txtID_Precio").val(data._id);
                    $("#txtNombre_Precio").val(data.nombre);
                });
                
            }
            
        </script>
    </head>
    <body>
        <div>
            <div><input type="text" id="txtID_Tipo" /></div>
            <div><input type="text" id="txtTipID_Tipo" /></div>
            <div><input type="text" id="txtNombre_Tipo" /></div>
            <div><input type="text" id="txtNivel_Tipo" /></div>
            <div><input type="button" value="Registra tipo" onclick="registraTipo()" /></div>
        </div>
        <br>
        <div>
            <div><input type="text" id="txtID_Producto" /></div>
            <div><input type="text" id="txtTipID_Producto" /></div>
            <div><input type="text" id="txtNombre_Producto" /></div>
            <div><input type="text" id="txtIngrediente_Producto" /></div>
            <div><input type="button" value="Registra producto" onclick="registraProducto()" /></div>
        </div>
        <br>
        <div>
            <div><input type="text" id="txtID_Ingrediente" /><input type="text" id="txtNombre_Ingrediente" /></div>
            <div><input type="text" id="txtID_Ingrediente_1" /><input type="text" id="txtNombre_Ingrediente_1" /></div>
            <div><input type="text" id="txtID_Ingrediente_2" /><input type="text" id="txtNombre_Ingrediente_2" /></div>
            <div><input type="text" id="txtID_Ingrediente_3" /><input type="text" id="txtNombre_Ingrediente_3" /></div>
            <div><input type="text" id="txtID_Ingrediente_4" /><input type="text" id="txtNombre_Ingrediente_4" /></div>
            <div><input type="text" id="txtID_Ingrediente_5" /><input type="text" id="txtNombre_Ingrediente_5" /></div>
            <div><input type="button" value="Registra ingredientes" onclick="registraProductoIngredientes()" /></div>
        </div>
        <div>
            <div><input type="text" id="txtID_Precio" /><input type="text" id="txtNombre_Precio" /></div>
            <div><input type="text" id="txtID_Precio_1" /><input type="text" id="txtNombre_Precio_1" /></div>
            <div><input type="text" id="txtID_Precio_2" /><input type="text" id="txtNombre_Precio_2" /></div>
            <div><input type="text" id="txtID_Precio_3" /><input type="text" id="txtNombre_Precio_3" /></div>
            <div><input type="text" id="txtID_Precio_4" /><input type="text" id="txtNombre_Precio_4" /></div>
            <div><input type="text" id="txtID_Precio_5" /><input type="text" id="txtNombre_Precio_5" /></div>
            <div><input type="button" value="Registra Precios" onclick="registraProductoPrecios()" /></div>
        </div>
    </body>
</html>